<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V2.0//EN" "http://forrest.apache.org/dtd/document-v20.dtd">
<document> 
  <header> 
    <title>Upgrading to Apache Forrest 0.8-dev</title> 
  </header> 
  <body> 
    <section id="introduction">
      <title>Introduction</title>
<note>
This is the <strong>development</strong> version of Apache Forrest which can
be obtained from the Subversion repository or from a code snapshot.
See the notes for obtaining and <a href="site:v0.80//build">Building Forrest</a>.
</note>
      <p>
      This page describes some changes to Apache Forrest that affect people who are
      upgrading to the 0.8 version.
      If you have other issues, then please discuss on either the
      <a href="site:mail-lists/forrest-dev">dev</a> or
      <a href="site:mail-lists/forrest-user">user</a>
      mailing lists.
      As more experience is gained, this document will be updated.  
      </p>
      <p>
      (If you are upgrading from a version prior to 0.7 then you will need
      to see the notes for the <a href="site:v0.60//upgrading_06">previous</a>
      upgrade.)
      </p>
    </section>

    <section id="new">
      <title>New Features</title>
      <p>
        The following list shows some of the key new features.
        For the full list of changes, see the main
        <a href="site:changes">change log</a> and also for each plugin.
      </p>
      <ul>
        <li><a href="site:locationmap">Locationmap</a>.</li>
      </ul>
      <p>Many new initial plugins are in the "whiteboard". See the entries in the
        <a href="site:changes">change log</a> and see each plugin's documentation and changes log.
        This includes the new Dispatcher.
        See <a href="site:v0.80//status-themes">Status of Themes: Skins and Dispatcher</a>.
      </p>
    </section>

    <section id="modules">
      <title>Forrest configuration simplification</title>
      <p>
        <strong>FOR-920</strong> Merging the
        <code>defaults</code> and
        <code>project</code> modules to the new
        <code>properties</code> module. You can use it like {properties:forrest.home}
        </p>
      <p> In all custom code (e.g. project sitemaps or plugins) you need to do the following: </p>
      
      <ul>
        <li>find:
          <code>{defaults:</code> and replace with
          <code>{properties:forrest.</code></li>
        <li>find:
          <code>{forrest:</code> and replace with
          <code>{forrest:forrest.</code> or
          <code>{properties:forrest.</code> (if you do not need the
          ChainMetaModule)</li>
        <li>find:
          <code>{project:</code> and replace with
          <code>{properties:</code></li>
      </ul>
    </section>

    <section id="clean">
      <title>Run a clean target after upgrade</title>
      <p>
        Do 'forrest clean-work' in each of your projects. This also removes
        the old Cocoon disk cache.
      </p>
    </section>

    <section id="to2to">
      <title>New filename convention for stylesheets</title>
      <p>
        There is now a filenaming convention for stylesheets (e.g. document-to-html.xsl).
        This assists with automating the location of such resources.
        See <a href="site:locationmap">Locationmap</a>.
      </p>
      <p>For the default use of Forrest, this makes no difference. However, if
        you have developed your own skin then you will need to do some filename changes, e.g.
        <code>'cd skins/my-skin/xslt/html; mv tab2menu.xsl tab-to-menu.xsl'</code> (do each of book2menu.xsl document2html.xsl site2xhtml.xsl tab2menu.xsl).
        It is advisable to follow this naming convention for your other resources,
        which will mean that you can utilise the locationmap.
      </p>
    </section>

    <section id="tips">
      <title>General upgrade tips</title>
      <p>
      Synchronise your project's skinconf.xml and forrest.properties files.
      </p>
      <p>
      Take advantage of the separation of concerns. In a new workspace,
      create a fresh
      '<code>forrest seed</code>' site, then tweak its forrest.properties
      and skinconf.xml until it reflects your old site.
      When it is ready, replace your project's skinconf.xml and
      forrest.properties files.
      Any remaining issues would concern other aspects of your configuration,
      such as site.xml and your actual content.
      </p>
    </section>

    <section>
      <title>To be continued...</title>
      <p>...as more issues are discovered/remembered :)  Please send feedback
      to the
      <a href="site:mail-lists/forrest-dev">mailing list</a>.</p>
    </section>
  </body>
</document>
